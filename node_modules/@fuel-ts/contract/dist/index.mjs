var E=Object.defineProperty,H=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var _=(t,n,a)=>n in t?E(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,y=(t,n)=>{for(var a in n||(n={}))x.call(n,a)&&_(t,a,n[a]);if(v)for(var a of v(n))P.call(n,a)&&_(t,a,n[a]);return t},k=(t,n)=>H(t,X(n));var V=(t,n)=>{var a={};for(var e in t)x.call(t,e)&&n.indexOf(e)<0&&(a[e]=t[e]);if(t!=null&&v)for(var e of v(t))n.indexOf(e)<0&&P.call(t,e)&&(a[e]=t[e]);return a};var t0=(t,n)=>{for(var a in n)E(t,a,{get:n[a],enumerable:!0})};import{Logger as o0}from"@ethersproject/logger";import{Interface as W}from"@fuel-ts/abi-coder";import{AbstractContract as s0}from"@fuel-ts/interfaces";import{coinQuantityfy as I,ScriptTransactionRequest as i0,Provider as c0}from"@fuel-ts/providers";import{Wallet as l0}from"@fuel-ts/wallet";import{arrayify as D,concat as U}from"@ethersproject/bytes";import{AbiCoder as j,NumberCoder as B}from"@fuel-ts/abi-coder";import{NativeAssetId as n0}from"@fuel-ts/constants";import{ReceiptType as a0}from"@fuel-ts/providers";import{Script as r0}from"@fuel-ts/script";var L=[{type:"function",inputs:[{name:"script_data",type:"struct ScriptData",components:[{name:"calls",type:"[enum Option; 5]",components:[{name:"__array_element",type:"enum Option",components:[{name:"Some",type:"struct Call",components:[{name:"contract_id",type:"struct ContractId",components:[{name:"value",type:"b256",components:null}]},{name:"fn_selector",type:"u64",components:null},{name:"fn_arg",type:"enum CallArg",components:[{name:"Value",type:"u64",components:null},{name:"Reference",type:"u64",components:null}]},{name:"amount",type:"u64",components:null},{name:"asset_id",type:"b256",components:null}]},{name:"None",type:"()",components:[]}]}]}]}],name:"main",outputs:[{name:"",type:"struct ScriptReturn",components:[{name:"call_returns",type:"[enum Option; 5]",components:[{name:"__array_element",type:"enum Option",components:[{name:"Some",type:"enum CallReturn",components:[{name:"Value",type:"u64",components:null},{name:"Reference",type:"(u64, u64)",components:[{name:"__tuple_element",type:"u64",components:null},{name:"__tuple_element",type:"u64",components:null}]}]},{name:"None",type:"()",components:[]}]}]}]}]}];var N="0x90000004470000000000000000000b905dfcc00110fff3001a605000910006685d43f00e104103005d47f0045d43f0055d41000010451400504183005f6110605d43f0067340001390000016504183005d41806090000019504183005d4180605d4100005045836050458360604502085d47f0045d43f0055d41000010451400504183085f611061504183085d4580615d43f00710450440504183205f6110645d43f0085d4500005d43f00720451400504182605f61104c504183205d498064504182605d41804c1a445000910000105f4520005f4500015041865850418658604110105d47f00926440000504470015041817850418178604110a05d43f00a26400000504070011a445000910000105f4500005d43f00a5f450001504183505041835060411010504182505d43f00a5f61004a50418360504100005d47f0075d43f00b12451400504182185f611043504182505d45804a504182185d418043164114007340005b9000024d5041836050490000504182505d41804a5545006810452440504180185041801860411068504180185d4500005d43f00a134114007340006a9000021e5041801850450008504180e8504180e860411060504180e850450028504180805041808060411010504180805d4500005d43f00a134114007340007a90000086504180805d450001504180a85f611015504180a85d4980151a445000910000105d43f00a5f4500005f452001900000a9504180805d4500005d43f00c134114007340008c9000009b504180805d450001504182b85f611057504186585d450000504182b85d418057104904401a445000910000105d43f00c5f4500005f452001900000a9504180805d450001504182c05f611058504186585d450000504182c05d418058104904401a445000910000105d43f00c5f4500005f452001504182205041822060411010504180e850590000504180e85d55000450458220504180e85d510007504180e8504d00401a5ca000504180005041800060411010504180005d4500005d43f00a13411400734000bf900000c6504180005d450001504180b05f611016504180b05d458016900000d9504180005d4500005d43f00c13411400734000cc900000d3504180005d450001504183105f611062504183105d458062900000d9504180005d450001504183285f611065504183285d458065504182305f611046504182305d4980461a4450009100003050411000604160205f4550045f452005504181485041814860411030504181482d4144d71a44e000504180105f611002504180105d4580025d43f00a13411400734000f1900000fc1a44d000504186285f6110c5504186285d4980c51a445000910000185d43f00a5f4500005f45200290000111504180105d458002504182685f61104d1a44d000504183305f611066504183305d458066504182685d41804d1a485000910000105f4910005f4900011a445000910000185d43f00c5f450000504110086041201050418338504183386041101850458338504180905041809060411018504180905d4500005d43f00a134114007340011e9000012a504180905d450002504186505f6110ca504186505d4980ca1a445000910000185d43f00a5f4500005f452002900001ef504180905d4500005d43f00c13411400734001309000019050418090504100085d450000504182f85f61105f50418090504100085d450001504182585f61104b504182f85d45805f504182585d41804b1a485000910000105f4910005f490001504180b8504180b86041201050558350505180b85d4540015d43f00a134114007340014c900001505d4550019000017f5d43f00a900001515d43f00a5d455001504182d85f61105b5d4550015d41400110450440504182985f6110535d4d50005d495001504182985d4580531541148073400160900001712644000050447001504182785f61104f5d43f00a15412400734001689000016d504182785d41804f284134805d43f00a9000016e5d43f00a504182785d4d804f900001715f553000504182985d4180535f5500015d455000504182d85d41805b104904405d4540005d414001284914005d43f00a504182d85d45805b504182c85f611059504182c85d458059504182585d41804b1a485000910000105f4910005f4900011a445000910000185d43f00c5f4500005041100860412010900001ef50418090504100085d450000504183185f61106350418090504100085d450001504182705f61104e504183185d458063504182705d41804e1a485000910000105f4910005f490001504180c8504180c86041201050558350505180c85d4540015d43f00a13411400734001ac900001b05d455001900001df5d43f00a900001b15d43f00a5d455001504182e05f61105c5d4550015d41400110450440504182a05f6110545d4d50005d495001504182a05d45805415411480734001c0900001d12644000050447001504182805f6110505d43f00a15412400734001c8900001cd504182805d418050284134805d43f00a900001ce5d43f00a504182805d4d8050900001d15f553000504182a05d4180545f5500015d455000504182e05d41805c104904405d4540005d414001284914005d43f00a504182e05d45805c504182d05f61105a504182d05d45805a504182705d41804e1a485000910000105f4910005f4900011a445000910000185d43f00c5f4500005041100860412010504182385041823860411018504982381a445000910000205d43f00a5f450000504110086041201850418608504186086041102050458178504182505d41804a55490020104914805d43f0061341000073400205900002095d43f00a364000005d43f00a9000020a5d43f00a504586085d43f0067340020e9000021b5d43f0061341000073400212900002165d43f00a364000005d43f00a900002175d43f00a5d43f00d284914005d43f00a9000021c5f4910005d43f00a90000246504186301a445000910000205d43f00c5f450000504186306041102050458178504182505d41804a55490020104914805d43f006134100007340022e900002325d43f00a364000005d43f00a900002335d43f00a504586305d43f00673400237900002445d43f006134100007340023b9000023f5d43f00a364000005d43f00a900002405d43f00a5d43f00d284914005d43f00a900002455f4910005d43f00a50418250504182505d45804a5d43f00c104104405f61004a90000054504981781a445000910000a050411000604120a05041856850418568604110a05d43f00a26400000504070011a445000910000105f4500005d43f00a5f450001504180d8504180d860411010505980d8505585685d43f00613410000734002669000026a5d43f00a364000005d43f00a9000026b5d43f00a504185685d53f0095d43f00a1341440073400271900002755d416001900002a15d43f00a900002765d43f00a5d456001504182e85f61105d5d41600110454400504182a85f6110555d4d60005d496001504182a85d4580551541148073400284900002952644000050447001504182885f6110515d43f00a154124007340028c90000291504182885d418051284134805d43f00a900002925d43f00a504182885d4d8051900002955f593000504182a85d4180555f5900015d456000504182e85d41805d10410440284155005d43f00a504182e85d41805d505580d8505183505d4540015d43f00a13411400734002a8900002ac5d415001900002db5d43f00a900002ad5d43f00a5d455001504182f05f61105e5d4550015d41400110450440504182b05f6110565d4d50005d495001504182b05d45805615411480734002bc900002cd2644000050447001504182905f6110525d43f00a15412400734002c4900002c9504182905d418052284134805d43f00a900002ca5d43f00a504182905d4d8052900002cd5f553000504182b05d4180565f5500015d455000504182f05d41805e104904405d4540005d414001284914005d43f00a504182f05d41805e504180d85d450000504180d85d41000125450000504585685d43f009254500004700000000000000000000000000000000000000000000000000000000000000000000000000000000002870000000000000282800000000000000010000000000000208000000000000283000000000000000a000000000000000000000000000000068000000000000000100000000000000200000000000000b90";var h=new r0(N,t=>{var s;let n=L[0].inputs,a=new j().getCoder(n[0]),e=a.coders.calls.length;if(t.length>e)throw new Error(`At most ${e} calls are supported`);let r=new Uint8Array,o=[];for(let f=0;f<e;f+=1){let u=t[f],d;if(u){let p=D(u.data),S=p.slice(0,8),l=p.slice(8,16).some(G=>G===1),m=p.slice(16),C;l?(C={Reference:r.length},r=U([r,m])):C={Value:new B("u64").decode(m,0)[0]},d={Some:{contract_id:{value:u.contractId},fn_selector:new B("u64").decode(S,0)[0],fn_arg:C,amount:BigInt((s=u.amount)!=null?s:0),asset_id:u.assetId||n0}}}else d={None:[]};o.push(d)}let i={calls:o},c=a.encode(i);return U([c,r])},t=>{if(t.code!==0n)throw new Error(`Script returned non-zero result: ${t.code}`);if(t.returnReceipt.type!==a0.ReturnData)throw new Error("Expected returnReceipt to be a ReturnDataReceipt");let n=D(t.returnReceipt.data),a=L[0].outputs,e=new j().getCoder(a[0]),[r,o]=e.decode(n,0),i=n.slice(o),c=[];return r.call_returns.forEach((s,f)=>{if(s.Some)if(s.Some.Reference){let[u,d]=s.Some.Reference;c[f]=i.slice(Number(u),Number(u+d))}else c[f]=new B("u64").encode(s.Some.Value)}),c});var w=new o0("0.0.0-master-65ffe7f"),d0=(t,n,a,e={})=>{let r=t.interface.encodeFunctionData(n,a),o=e.forward&&I(e.forward);return{contractId:t.id,data:r,assetId:o==null?void 0:o.assetId,amount:o==null?void 0:o.amount,gas:e.gasLimit}},T=(t,n)=>{let a=n.slice(0,t.inputs.length),e=n.slice(t.inputs.length);return[a,...e]},u0=t=>(n,a)=>{var i;let e=I(a),r=(i=t.get(n))!=null?i:[],o=r.find(c=>c.assetId===e.assetId);o?o.amount+=e.amount:t.set(n,[...r,e])},g=async(t,n={})=>{var S;let p=n,{fundTransaction:a}=p,e=V(p,["fundTransaction"]),r=new Set,o=0,i=new Map,c=u0(i),s=0,f=[];for(let l of t){r.add(l.contract),l.options.gasLimit&&(o+=Number(l.options.gasLimit));let m=l.options.forward&&I(l.options.forward);if(m){let C=l.contract.wallet;if(!C)throw new Error("Cannot get coins without a wallet");c(C,m)}l.options.variableOutputs&&(s+=l.options.variableOutputs),f.push(d0(l.contract,l.func,l.args,l.options))}let u=(S=e.gasLimit)!=null?S:1e6;if(u<o)throw new Error(`Gas limit ${u} is insufficient for the transaction, at least ${o} is required.`);let d=new i0(y({gasLimit:u},e));d.setScript(h,f);for(let l of r)d.addContract(l);if(s&&d.addVariableOutputs(s),n!=null&&n.fundTransaction){let l=t[0].contract.wallet;if(!l)throw new Error("Cannot fund transaction without a wallet");let m=d.calculateFee();c(l,[m])}for(let[l,m]of i){let C=await l.getCoinsToSpend(m);d.addCoins(C)}return typeof e.transformRequest=="function"?e.transformRequest(d):d},f0=(t,n)=>function(...e){let[r,o={}]=T(n,e);return{contract:t,func:n,args:r,options:o}},M=(t,n)=>async function(...e){if(!t.provider)return w.throwArgumentError("Cannot call without provider","provider",t.provider);let[r,o={}]=T(n,e),c=await g([{contract:t,func:n,args:r,options:o}],o);return await t.provider.call(c,{utxoValidation:!1})},p0=(t,n)=>async function(...e){let r=await M(t,n).apply(t,e),i=h.decodeCallResult(r)[0];return t.interface.decodeFunctionResult(n,i)[0]},Z=(t,n)=>async function(...e){if(!t.wallet)return w.throwArgumentError("Cannot call without wallet","wallet",t.wallet);let[r,o={}]=T(n,e),c=await g([{contract:t,func:n,args:r,options:o}],k(y({},o),{fundTransaction:!0}));return await(await t.wallet.sendTransaction(c)).waitForResult()},m0=(t,n)=>async function(...e){var s;let r=await Z(t,n).apply(t,e),i=h.decodeCallResult(r)[0];return(s=t.interface.decodeFunctionResult(n,i))==null?void 0:s[0]},z=(t,n)=>async function(...e){if(!t.wallet)return w.throwArgumentError("Cannot call without wallet","wallet",t.wallet);let[r,o={}]=T(n,e),c=await g([{contract:t,func:n,args:r,options:o}],k(y({},o),{fundTransaction:!0}));return t.wallet.simulateTransaction(c)},y0=(t,n)=>async function(...e){var s;let r=await z(t,n).apply(t,e),i=h.decodeCallResult(r)[0];return(s=t.interface.decodeFunctionResult(n,i))==null?void 0:s[0]},b=class extends s0{constructor(a,e,r=null,o,i){super();this.interface=e instanceof W?e:new W(e),this.id=a,this.transaction=o,this.request=i,r instanceof l0?(this.provider=r.provider,this.wallet=r):r instanceof c0?(this.provider=r,this.wallet=null):(this.provider=null,this.wallet=null),this.dryRun={},this.dryRunResult={},this.submit={},this.submitResult={},this.prepareCall={},this.simulate={},this.simulateResult={},Object.keys(this.interface.functions).forEach(c=>{let s=this.interface.getFunction(c);Object.defineProperty(this.prepareCall,s.name,{value:f0(this,s),writable:!1}),Object.defineProperty(this.submit,s.name,{value:m0(this,s),writable:!1}),Object.defineProperty(this.submitResult,s.name,{value:Z(this,s),writable:!1}),Object.defineProperty(this.dryRun,s.name,{value:p0(this,s),writable:!1}),Object.defineProperty(this.dryRunResult,s.name,{value:M(this,s),writable:!1}),Object.defineProperty(this.simulateResult,s.name,{value:z(this,s),writable:!1}),Object.defineProperty(this.simulate,s.name,{value:y0(this,s),writable:!1})})}async dryRunMulticall(a,e={}){if(!this.provider)return w.throwArgumentError("Cannot call without provider","provider",this.provider);let r=await g(a,e),o=await this.provider.call(r,{utxoValidation:!1});return h.decodeCallResult(o).map((s,f)=>{var d;let u=a[f].func;return(d=this.interface.decodeFunctionResult(u,s))==null?void 0:d[0]})}async submitMulticall(a,e={}){if(!this.wallet)return w.throwArgumentError("Cannot call without wallet","wallet",this.wallet);let r=await g(a,y({fundTransaction:!0},e)),i=await(await this.wallet.sendTransaction(r)).waitForResult();return h.decodeCallResult(i).map((f,u)=>{var p;let d=a[u].func;return(p=this.interface.decodeFunctionResult(d,f))==null?void 0:p[0]})}async simulateMulticall(a,e={}){if(!this.wallet)return w.throwArgumentError("Cannot call without wallet","wallet",this.wallet);let r=await g(a,y({fundTransaction:!0},e));return this.wallet.simulateTransaction(r)}};import{Logger as g0}from"@ethersproject/logger";import{Interface as Y}from"@fuel-ts/abi-coder";import{ZeroBytes32 as b0}from"@fuel-ts/constants";import{randomBytes as R0}from"@fuel-ts/keystore";import{Provider as A0,CreateTransactionRequest as F0}from"@fuel-ts/providers";import{Wallet as S0}from"@fuel-ts/wallet";var K={};t0(K,{getContractId:()=>O,getContractRoot:()=>$,getContractStorageRoot:()=>w0});import{hexlify as J,arrayify as q,concat as C0}from"@ethersproject/bytes";import{sha256 as h0}from"@ethersproject/sha2";import{calcRoot as Q}from"@fuel-ts/merkle";var $=t=>{let a=[];for(let e=0;e<t.length;e+=8){let r=new Uint8Array(8);r.set(t.slice(e,e+8)),a.push(r)}return Q(a.map(e=>J(e)))},w0=t=>{let e=[];for(let[r,o]of t){let i=new Uint8Array(64);i.set(q(r)),i.set(q(o),32),e.push(i)}return Q(e.map(r=>J(r)))},O=(t,n,a)=>{let e=$(q(t));return h0(C0(["0x4655454C",n,e,a]))};var v0=new g0("0.0.0-master-65ffe7f"),R=class{constructor(n,a,e=null){this.bytecode=n,a instanceof Y?this.interface=a:this.interface=new Y(a),e instanceof S0?(this.provider=e.provider,this.wallet=e):e instanceof A0?(this.provider=e,this.wallet=null):(this.provider=null,this.wallet=null)}connect(n){return new R(this.bytecode,this.interface,n)}async deployContract(n){if(!this.wallet)return v0.throwArgumentError("Cannot deploy without wallet","wallet",this.wallet);let a=y({salt:R0(32),storageSlots:[]},n),e=b0,r=O(this.bytecode,a.salt,e),o=new F0(y({gasPrice:0,gasLimit:1e6,bytePrice:0,bytecodeWitnessIndex:0,witnesses:[this.bytecode]},a));o.addContractCreatedOutput(r,e),await this.wallet.fund(o);let i=await this.wallet.sendTransaction(o);return await i.wait(),new b(r,this.interface,this.wallet,i.id,i.request)}};export{b as Contract,R as ContractFactory,K as ContractUtils,g as buildTransaction};
//# sourceMappingURL=index.mjs.map